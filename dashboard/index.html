<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Safe Stack Dashboard</title>
  <link rel="stylesheet" href="assets/vendor/quill.snow.css" />
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <header>
    <h1>Safe Stack Web Workspace</h1>
    <p>左上: VS Code / 右上: アプリプレビュー / 左下: ターミナル / 右下: メモ・ログ・追加ビュー</p>
  </header>
  <main class="grid">
    <section class="tile" aria-label="VS Code">
      <div class="tile__header">
        <h2>VS Code</h2>
        <a data-service-link="vscode" data-base-path="/vscode/" href="#" target="_blank" rel="noreferrer noopener">別タブで開く</a>
      </div>
      <iframe data-service="vscode" data-base-path="/vscode/" src="about:blank" title="VS Code" allow="clipboard-read; clipboard-write" loading="lazy"></iframe>
    </section>
    <section class="tile" aria-label="アプリプレビュー">
      <div class="tile__header">
        <h2>アプリプレビュー</h2>
        <form id="preview-controls" class="tile__actions tile__actions--preview">
          <label class="visually-hidden" for="preview-url">プレビュー URL</label>
          <input id="preview-url" name="preview-url" type="text" inputmode="url" placeholder="/preview/ または http://..." autocomplete="off" />
          <button type="submit" title="入力した URL を適用">適用</button>
          <button id="reload-preview" type="button" title="プレビューだけを再読込">リロード</button>
          <a data-preview-link href="/preview/" target="_blank" rel="noreferrer noopener">別タブで開く</a>
        </form>
      </div>
      <iframe data-preview-frame src="/preview/" title="アプリプレビュー" loading="lazy"></iframe>
    </section>
    <section class="tile" aria-label="ターミナル">
      <div class="tile__header">
        <div class="tile__header-row">
          <h2>ターミナル</h2>
        </div>
        <div class="tile__tabs" role="tablist">
          <button type="button" class="tile__tab" data-terminal-target="1" role="tab" aria-selected="true">ターミナル 1</button>
          <button type="button" class="tile__tab" data-terminal-target="2" role="tab" aria-selected="false">ターミナル 2</button>
          <button type="button" class="tile__tab" data-terminal-target="3" role="tab" aria-selected="false">ターミナル 3</button>
        </div>
      </div>
      <div class="tile__content">
        <iframe class="terminal-frame" data-terminal-id="1" src="/terminal/1/" title="ターミナル 1" allow="clipboard-read; clipboard-write" loading="lazy"></iframe>
        <iframe class="terminal-frame" data-terminal-id="2" src="/terminal/2/" title="ターミナル 2" allow="clipboard-read; clipboard-write" loading="lazy" hidden></iframe>
        <iframe class="terminal-frame" data-terminal-id="3" src="/terminal/3/" title="ターミナル 3" allow="clipboard-read; clipboard-write" loading="lazy" hidden></iframe>
      </div>
    </section>
    <section class="tile" aria-label="ユーティリティ">
      <div class="tile__header">
        <div class="tile__header-row">
          <h2>ユーティリティ</h2>
          <div class="tile__actions tile__actions--notes" data-actions-for="notes">
            <button id="clear-notes" type="button" title="メモをクリア">クリア</button>
            <button id="download-notes" type="button" title="メモをダウンロード">ダウンロード</button>
          </div>
        </div>
        <div class="tile__tabs" role="tablist">
          <button type="button" class="tile__tab" data-aux-target="notes" role="tab" aria-selected="true">メモ</button>
          <button type="button" class="tile__tab" data-aux-target="logs" role="tab" aria-selected="false">ログ</button>
          <button type="button" class="tile__tab" data-aux-target="streamlit" role="tab" aria-selected="false">Streamlit</button>
          <button type="button" class="tile__tab" data-aux-target="docs" role="tab" aria-selected="false">API Docs</button>
        </div>
      </div>
      <div class="tile__content">
        <div class="aux aux--notes" data-mode="notes">
          <div id="notes-editor" class="notes__editor" aria-label="メモ入力欄"></div>
          <label class="notes__hint">ブラウザのローカルストレージに自動保存されます</label>
        </div>
        <div class="aux aux--logs" data-mode="logs" hidden>
          <div class="logs__controls">
            <label class="visually-hidden" for="logs-service">ログ種別</label>
            <select id="logs-service">
              <option value="frontend">フロントエンド</option>
              <option value="backend">バックエンド</option>
              <option value="streamlit">Streamlit</option>
            </select>
            <label class="visually-hidden" for="logs-tail">取得行数</label>
            <select id="logs-tail">
              <option value="200">200 行</option>
              <option value="500">500 行</option>
              <option value="1000">1000 行</option>
            </select>
            <label class="logs__autorefresh" for="logs-auto-refresh">
              <input id="logs-auto-refresh" type="checkbox" />
              自動更新
            </label>
            <button id="logs-refresh" type="button">更新</button>
          </div>
          <pre id="logs-output" class="logs__output" role="log" aria-live="polite"></pre>
          <p id="logs-status" class="logs__status" aria-live="polite"></p>
        </div>
        <iframe class="aux aux--iframe" data-mode="streamlit" src="/streamlit/" title="Streamlit" loading="lazy" hidden></iframe>
        <iframe class="aux aux--iframe" data-mode="docs" src="/api/docs" title="API Docs" loading="lazy" hidden></iframe>
      </div>
    </section>
  </main>
  <footer>
    <small>ホットキー: Ctrl+Shift+Alt+D でフルスクリーン切替</small>
  </footer>
  <script src="assets/vendor/quill.min.js"></script>
  <script src="assets/dashboard.js" type="module"></script>
</body>
</html>
